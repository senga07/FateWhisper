#!/usr/bin/env python3
"""
ç‹¬ç«‹çš„ Parlant æœåŠ¡å™¨å¯åŠ¨è„šæœ¬

ä½¿ç”¨æ–¹æ³•:
    python parlant_server.py

è¯¥è„šæœ¬ä¼šå¯åŠ¨ Parlant æœåŠ¡å™¨ï¼Œè¿è¡Œåœ¨ http://localhost:8800
æ—¥å¿—æ–‡ä»¶ä¿å­˜åœ¨: parlant-data/parlant.log

é…ç½®æ–¹å¼:
    1. ä»ç¯å¢ƒå˜é‡è¯»å–ï¼ˆæ¨èï¼‰
    2. ä» .env æ–‡ä»¶è¯»å–ï¼ˆå¦‚æœå®‰è£…äº† python-dotenvï¼‰
    3. ç›´æ¥åœ¨ä»£ç ä¸­è®¾ç½®ï¼ˆä¸æ¨èï¼‰
"""
import asyncio
import os
import sys
import parlant.sdk as p
from tools.bazi_tools import tian_gan_di_zhi
import datetime


# ä¿®å¤ JSON ç¼–ç é—®é¢˜ï¼šç¡®ä¿ä¸­æ–‡å­—ç¬¦ä¸è¢«è½¬ä¹‰ä¸º Unicode è½¬ä¹‰åºåˆ—
from utils.fix_json_encoding import fix_parlant_json_encoding
fix_parlant_json_encoding()

# æ·»åŠ å½“å‰ç›®å½•åˆ° Python è·¯å¾„ï¼Œä»¥ä¾¿å¯¼å…¥é¡¹ç›®æ¨¡å—
sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))

def setEnviron():
    # å°è¯•åŠ è½½ .env æ–‡ä»¶ï¼ˆå¦‚æœå®‰è£…äº† python-dotenvï¼‰
    try:
        from dotenv import load_dotenv
        # åŠ è½½ .env æ–‡ä»¶
        env_path = os.path.join(os.path.dirname(os.path.abspath(__file__)), '.env')
        if os.path.exists(env_path):
            load_dotenv(env_path)
            print(f"âœ… å·²åŠ è½½ .env æ–‡ä»¶: {env_path}")
    except ImportError:
        # å¦‚æœæ²¡æœ‰å®‰è£… python-dotenvï¼Œè·³è¿‡
        pass
    # è®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆparlant ä¼šä»ç¯å¢ƒå˜é‡è¯»å–ï¼‰
    os.environ['AZURE_ENDPOINT'] = os.getenv('AZURE_OPENAI_ENDPOINT')
    os.environ['AZURE_API_KEY'] = os.getenv('AZURE_OPENAI_API_KEY')
    os.environ['AZURE_GENERATIVE_MODEL_NAME'] = 'gpt-4o'
    os.environ['AZURE_API_VERSION'] = os.getenv('AZURE_OPENAI_API_VERSION')
setEnviron()


@p.tool
async def get_bazi_by_lunar(context: p.ToolContext, lunar: str) -> p.ToolResult:
    """
    æ ¹æ®é˜´å†å‡ºç”Ÿæ—¥æœŸè®¡ç®—å…«å­—
    
    Args:
        context: Parlant å·¥å…·ä¸Šä¸‹æ–‡
        lunar: ç”¨æˆ·è¾“å…¥çš„å‡ºç”Ÿæ—¥æœŸï¼ˆå¯èƒ½æ˜¯å„ç§æ ¼å¼ï¼‰
    """
    date_str = str(lunar).strip()
    
    # é¦–å…ˆå°è¯•ç›´æ¥è§£ææ ‡å‡†æ ¼å¼
    try:
        date_formats = "%Y-%m-%d %H:%M"
        parsed_datetime = datetime.datetime.strptime(date_str, date_formats)
    except ValueError:
        return p.ToolResult([f"æŠ±æ­‰ï¼Œè€å¤«æœªèƒ½è¯†åˆ«æ‚¨æä¾›çš„æ—¥æœŸæ ¼å¼ï¼š{date_str}ã€‚\nè¯·æä¾›æ ‡å‡†çš„æ—¥æœŸæ—¶é—´æ ¼å¼ï¼Œä¾‹å¦‚ï¼š1949-12-12 06:15ã€‚"])
    
    # æå–å¹´æœˆæ—¥æ—¶
    year = parsed_datetime.year
    month = parsed_datetime.month
    day = parsed_datetime.day
    hour = parsed_datetime.hour

    # è®¡ç®—å…«å­—
    year_zhu, month_zhu, day_zhu, hour_zhu = tian_gan_di_zhi(year, month, day, hour)
    
    # æ›´ä¼ ç»Ÿçš„å…«å­—å±•ç¤ºæ ¼å¼
    bazi_info = f"""å…«å­—æ’ç›˜ï¼š
å¹´æŸ±ï¼š{year_zhu}
æœˆæŸ±ï¼š{month_zhu}
æ—¥æŸ±ï¼š{day_zhu}
æ—¶æŸ±ï¼š{hour_zhu}

è€å¤«å·²ä¸ºæ–½ä¸»æ’å¥½å…«å­—ï¼Œè¿™å››æŸ±ä¹‹ä¸­ï¼Œå¹´æŸ±ä¸»ç¥–ä¸Šæ ¹åŸºï¼ŒæœˆæŸ±ä¸»çˆ¶æ¯å…„å¼Ÿï¼Œæ—¥æŸ±ä¸»è‡ªèº«ï¼Œæ—¶æŸ±ä¸»å­å¥³æ™šè¿ã€‚å¾…è€å¤«ç»†ç»†æ¨æ•²ä¸€ç•ª..."""
    
    return p.ToolResult([bazi_info])


async def add_domain_glossary(agent: p.Agent) -> None:
    # ä¼ ç»Ÿå‘½ç†æœ¯è¯­
    await agent.create_term(
        name="å¤©å¹²åœ°æ”¯",
        description="å¤©å¹²æœ‰åï¼šç”²ä¹™ä¸™ä¸æˆŠå·±åºšè¾›å£¬ç™¸ï¼›åœ°æ”¯æœ‰åäºŒï¼šå­ä¸‘å¯…å¯è¾°å·³åˆæœªç”³é…‰æˆŒäº¥ã€‚å¤©å¹²åœ°æ”¯ç»„åˆæˆå…­åç”²å­ï¼Œç”¨äºçºªå¹´ã€çºªæœˆã€çºªæ—¥ã€çºªæ—¶ã€‚",
    )
    
    await agent.create_term(
        name="äº”è¡Œ",
        description="é‡‘ã€æœ¨ã€æ°´ã€ç«ã€åœŸäº”ç§å…ƒç´ ï¼Œç›¸ç”Ÿç›¸å…‹ï¼Œæ„æˆå‘½ç†åˆ†æçš„åŸºç¡€ã€‚",
    )
    
    await agent.create_term(
        name="åç¥",
        description="æ¯”è‚©ã€åŠ«è´¢ã€é£Ÿç¥ã€ä¼¤å®˜ã€åè´¢ã€æ­£è´¢ã€ä¸ƒæ€ã€æ­£å®˜ã€åå°ã€æ­£å°ï¼Œç”¨äºåˆ†æå‘½å±€ä¸­çš„å„ç§å…³ç³»ã€‚",
    )
    
    await agent.create_term(
        name="å¤§è¿",
        description="äººç”Ÿä¸åŒé˜¶æ®µçš„è¿åŠ¿å˜åŒ–ï¼Œæ¯åå¹´ä¸ºä¸€å¤§è¿ï¼Œå½±å“äººç”Ÿå„ä¸ªæ–¹é¢çš„å‰å‡¶ã€‚",
    )
    
    await agent.create_term(
        name="æµå¹´",
        description="æ¯å¹´çš„è¿åŠ¿å˜åŒ–ï¼Œç»“åˆå¤§è¿å’Œå…«å­—ï¼Œå¯ä»¥é¢„æµ‹å½“å¹´çš„å‰å‡¶ç¥¸ç¦ã€‚",
    )
    
    await agent.create_term(
        name="æ—¶è¾°",
        description="å¤ä»£å°†ä¸€å¤©åˆ†ä¸ºåäºŒä¸ªæ—¶è¾°ï¼šå­æ—¶(23-1)ã€ä¸‘æ—¶(1-3)ã€å¯…æ—¶(3-5)ã€å¯æ—¶(5-7)ã€è¾°æ—¶(7-9)ã€å·³æ—¶(9-11)ã€åˆæ—¶(11-13)ã€æœªæ—¶(13-15)ã€ç”³æ—¶(15-17)ã€é…‰æ—¶(17-19)ã€æˆŒæ—¶(19-21)ã€äº¥æ—¶(21-23)ã€‚",
    )
    
    await agent.create_term(
        name="é¢ç›¸",
        description="é€šè¿‡è§‚å¯Ÿäººçš„é¢éƒ¨ç‰¹å¾ï¼ˆäº”å®˜ã€è½®å»“ã€æ°”è‰²ç­‰ï¼‰æ¥åˆ†ææ€§æ ¼ã€è¿åŠ¿å’Œå‘½è¿çš„ä¼ ç»Ÿå‘½ç†æ–¹æ³•ã€‚",
    )
    
    await agent.create_term(
        name="ä¸‰åœ",
        description="é¢ç›¸å­¦ä¸­å°†é¢éƒ¨çºµå‘åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šä¸Šåœï¼ˆé¢å¤´ï¼Œä¸»æ—©å¹´è¿åŠ¿ï¼‰ã€ä¸­åœï¼ˆçœ‰çœ¼é¼»ï¼Œä¸»ä¸­å¹´è¿åŠ¿ï¼‰ã€ä¸‹åœï¼ˆå£ä¸‹å·´ï¼Œä¸»æ™šå¹´è¿åŠ¿ï¼‰ã€‚",
    )
    
    await agent.create_term(
        name="äº”å²³",
        description="é¢ç›¸å­¦ä¸­çš„äº”ä¸ªé‡è¦éƒ¨ä½ï¼šé¢å¤´ä¸ºå—å²³è¡¡å±±ï¼Œä¸‹å·´ä¸ºåŒ—å²³æ’å±±ï¼Œå·¦é¢§ä¸ºä¸œå²³æ³°å±±ï¼Œå³é¢§ä¸ºè¥¿å²³åå±±ï¼Œé¼»å­ä¸ºä¸­å²³åµ©å±±ã€‚",
    )
    
    await agent.create_term(
        name="åäºŒå®«",
        description="é¢ç›¸å­¦ä¸­å°†é¢éƒ¨åˆ’åˆ†ä¸ºåäºŒä¸ªå®«ä½ï¼Œåˆ†åˆ«ä»£è¡¨ä¸åŒçš„è¿åŠ¿ï¼šå‘½å®«ã€è´¢å¸›å®«ã€å…„å¼Ÿå®«ã€ç”°å®…å®«ã€ç”·å¥³å®«ã€å¥´ä»†å®«ã€å¦»å¦¾å®«ã€ç–¾å„å®«ã€è¿ç§»å®«ã€å®˜ç¦„å®«ã€ç¦å¾·å®«ã€ç›¸è²Œå®«ã€‚",
    )
    
    await agent.create_term(
        name="æ‰‹ç›¸",
        description="é€šè¿‡è§‚å¯Ÿäººçš„æ‰‹æŒç‰¹å¾ï¼ˆæŒå‹ã€æŒçº¹ã€æŒä¸˜ã€æ‰‹æŒ‡ç­‰ï¼‰æ¥åˆ†ææ€§æ ¼ã€è¿åŠ¿å’Œå‘½è¿çš„ä¼ ç»Ÿå‘½ç†æ–¹æ³•ã€‚",
    )
    
    await agent.create_term(
        name="ç”Ÿå‘½çº¿",
        description="æ‰‹ç›¸å­¦ä¸­ä»æ‹‡æŒ‡å’Œé£ŸæŒ‡ä¹‹é—´å¼€å§‹ï¼Œæ²¿ç€æ‹‡æŒ‡æ ¹éƒ¨å»¶ä¼¸çš„æŒçº¹ï¼Œä¸»è¦åæ˜ å¥åº·çŠ¶å†µå’Œç”Ÿå‘½åŠ›ã€‚",
    )
    
    await agent.create_term(
        name="æ™ºæ…§çº¿",
        description="æ‰‹ç›¸å­¦ä¸­ä»æ‹‡æŒ‡å’Œé£ŸæŒ‡ä¹‹é—´å¼€å§‹ï¼Œæ¨ªè´¯æ‰‹æŒçš„æŒçº¹ï¼Œä¸»è¦åæ˜ æ™ºåŠ›ã€æ€ç»´æ–¹å¼å’Œå­¦ä¹ èƒ½åŠ›ã€‚",
    )
    
    await agent.create_term(
        name="æ„Ÿæƒ…çº¿",
        description="æ‰‹ç›¸å­¦ä¸­ä»å°æŒ‡ä¸‹æ–¹å¼€å§‹ï¼Œæ¨ªè´¯æ‰‹æŒä¸Šæ–¹çš„æŒçº¹ï¼Œä¸»è¦åæ˜ æ„Ÿæƒ…ç”Ÿæ´»ã€äººé™…å…³ç³»å’Œæƒ…æ„Ÿè¡¨è¾¾ã€‚",
    )
    
    await agent.create_term(
        name="äº‹ä¸šçº¿",
        description="æ‰‹ç›¸å­¦ä¸­ä»æ‰‹æŒåº•éƒ¨å‘ä¸Šå»¶ä¼¸çš„æŒçº¹ï¼Œä¸»è¦åæ˜ äº‹ä¸šå‘å±•ã€èŒä¸šæˆå°±å’Œç¤¾ä¼šåœ°ä½ã€‚",
    )
    
    await agent.create_term(
        name="å©šå§»çº¿",
        description="æ‰‹ç›¸å­¦ä¸­ä½äºå°æŒ‡ä¸‹æ–¹ï¼Œæ„Ÿæƒ…çº¿ä¸Šæ–¹çš„çŸ­æ¨ªçº¿ï¼Œä¸»è¦åæ˜ å©šå§»çŠ¶å†µå’Œæ„Ÿæƒ…å…³ç³»ã€‚",
    )
    
    await agent.create_term(
        name="æŒä¸˜",
        description="æ‰‹ç›¸å­¦ä¸­æ‰‹æŒä¸Šéš†èµ·çš„éƒ¨ä½ï¼ŒåŒ…æ‹¬é‡‘æ˜Ÿä¸˜ã€æœ¨æ˜Ÿä¸˜ã€åœŸæ˜Ÿä¸˜ã€å¤ªé˜³ä¸˜ã€æ°´æ˜Ÿä¸˜ã€æœˆä¸˜ã€ç«æ˜Ÿä¸˜ç­‰ï¼Œåˆ†åˆ«ä»£è¡¨ä¸åŒçš„è¿åŠ¿å’Œæ€§æ ¼ç‰¹å¾ã€‚",
    )


async def create_bazi_journey(server: p.Server, agent: p.Agent) -> p.Journey:
    journey = await agent.create_journey(
        title="å…«å­—æµ‹ç®—",
        description="é€šè¿‡é˜´å†çš„å‡ºç”Ÿæ—¥æœŸå’Œæ—¶è¾°æ¥æ¨æ¼”ä¸€ä¸ªäººçš„å‘½ç†èµ°å‘",
        conditions=["å’¨è¯¢äººæƒ³è¦ç®—å‘½", "ç”¨æˆ·è¯¢é—®å‘½ç†", "ç”¨æˆ·æƒ³äº†è§£è¿åŠ¿"]
    )
    t0 = await journey.initial_state.transition_to(
        chat_state="""è€å¤«è§æ–½ä¸»å‰æ¥é—®å‘½ï¼Œç”šæ˜¯æ¬£æ…°ã€‚è¦æ¨ç®—å…«å­—ï¼Œéœ€çŸ¥æ–½ä¸»çš„ç”Ÿè¾°å…«å­—ã€‚
è¯·å‘ŠçŸ¥è€å¤«æ‚¨çš„é˜´å†ï¼ˆå†œå†ï¼‰å‡ºç”Ÿæ—¥æœŸå’Œæ—¶è¾°ï¼Œæ ¼å¼å¦‚ï¼š1949-12-12 06:15ã€‚
æ—¶è¾°å¾ˆé‡è¦ï¼Œè¯·åŠ¡å¿…å‡†ç¡®å‘ŠçŸ¥ã€‚"""
    )

    t1 = await t0.target.transition_to(
        tool_state=get_bazi_by_lunar,
        condition="ç”¨æˆ·æä¾›äº†é˜´å†å‡ºç”Ÿæ—¥æœŸå’Œæ—¶è¾°"
    )

    t2 = await t1.target.transition_to(
        chat_state="""è€å¤«å·²ä¸ºæ–½ä¸»æ¨ç®—å‡ºå…«å­—ï¼Œè¿™å…«å­—ä¸­æš—è—ç„æœºã€‚
æ–½ä¸»æƒ³äº†è§£å“ªæ–¹é¢çš„å‘½ç†ï¼Ÿæ¯”å¦‚ï¼š
- æ€§æ ¼å“æ€§
- äº‹ä¸šå‰ç¨‹
- è´¢è¿èµ°åŠ¿
- å©šå§»æ„Ÿæƒ…
- å¥åº·è¿åŠ¿
- æˆ–è€…è®©è€å¤«ä¸ºæ‚¨å…¨é¢åˆ†æä¸€ç•ª

è¯·å‘ŠçŸ¥è€å¤«æ‚¨æœ€å…³å¿ƒçš„é—®é¢˜ã€‚"""
    )

    return journey


async def create_face_reading_journey(server: p.Server, agent: p.Agent) -> p.Journey:
    journey = await agent.create_journey(
        title="é¢ç›¸åˆ†æ",
        description="é€šè¿‡ä¸Šä¼ æ­£è„¸ç…§ç‰‡æ¥è¿›è¡Œé¢ç›¸åˆ†æï¼Œäº†è§£æ€§æ ¼ã€è¿åŠ¿å’Œå‘½è¿",
        conditions=["ç”¨æˆ·æƒ³çœ‹é¢ç›¸", "ç”¨æˆ·è¯¢é—®é¢ç›¸", "ç”¨æˆ·æƒ³äº†è§£é¢ç›¸åˆ†æ", "ç”¨æˆ·ä¸Šä¼ äº†ç…§ç‰‡"]
    )
    t0 = await journey.initial_state.transition_to(
        chat_state="""è€å¤«è§æ–½ä¸»æƒ³äº†è§£é¢ç›¸ï¼Œç”šæ˜¯æ¬£æ…°ã€‚é¢ç›¸å­¦ä¹ƒä¼ ç»Ÿå‘½ç†ä¹‹é‡è¦åˆ†æ”¯ï¼Œé€šè¿‡è§‚å¯Ÿé¢éƒ¨ç‰¹å¾ï¼Œå¯çª¥è§æ€§æ ¼ã€è¿åŠ¿ä¹‹ç«¯å€ªã€‚

è¦å‡†ç¡®åˆ†æé¢ç›¸ï¼Œéœ€è¦æ–½ä¸»æä¾›ä¸€å¼ æ¸…æ™°çš„æ­£è„¸ç…§ç‰‡ã€‚è¦æ±‚å¦‚ä¸‹ï¼š
- æ­£é¢æ‹æ‘„ï¼Œäº”å®˜æ¸…æ™°å¯è§
- å…‰çº¿å……è¶³ï¼Œé¢éƒ¨ç‰¹å¾æ¸…æ¥š
- è¡¨æƒ…è‡ªç„¶ï¼Œä¸è¦é®æŒ¡é¢éƒ¨
- æœ€å¥½ç´ é¢œæˆ–æ·¡å¦†

è¯·ä¸Šä¼ æ‚¨çš„æ­£è„¸ç…§ç‰‡ï¼Œè€å¤«å°†ä¸ºæ‚¨è¯¦ç»†åˆ†æã€‚"""
    )

    t1 = await t0.target.transition_to(
        chat_state="""è€å¤«å·²ä¸ºæ–½ä¸»åˆ†æå®Œé¢ç›¸ï¼Œè¿™é¢ç›¸ä¹‹ä¸­æš—è—ç„æœºã€‚
æ–½ä¸»æƒ³äº†è§£å“ªæ–¹é¢çš„å‘½ç†ï¼Ÿæ¯”å¦‚ï¼š
- æ€§æ ¼å“æ€§
- äº‹ä¸šå‰ç¨‹
- è´¢è¿èµ°åŠ¿
- å©šå§»æ„Ÿæƒ…
- å¥åº·è¿åŠ¿
- æˆ–è€…è®©è€å¤«ä¸ºæ‚¨å…¨é¢åˆ†æä¸€ç•ª

è¯·å‘ŠçŸ¥è€å¤«æ‚¨æœ€å…³å¿ƒçš„é—®é¢˜ã€‚""",
    condition = "ç”¨æˆ·ä¸Šä¼ äº†æ­£è„¸ç…§ç‰‡"
    )

    return journey


async def create_palm_reading_journey(server: p.Server, agent: p.Agent) -> p.Journey:
    journey = await agent.create_journey(
        title="æ‰‹ç›¸åˆ†æ",
        description="é€šè¿‡ä¸Šä¼ æ‰‹æŒç…§ç‰‡æ¥è¿›è¡Œæ‰‹ç›¸åˆ†æï¼Œäº†è§£æ€§æ ¼ã€è¿åŠ¿å’Œå‘½è¿",
        conditions=["ç”¨æˆ·æƒ³çœ‹æ‰‹ç›¸", "ç”¨æˆ·è¯¢é—®æ‰‹ç›¸", "ç”¨æˆ·æƒ³äº†è§£æ‰‹ç›¸åˆ†æ", "ç”¨æˆ·ä¸Šä¼ äº†æ‰‹ç›¸ç…§ç‰‡"]
    )
    t0 = await journey.initial_state.transition_to(
        chat_state="""è€å¤«è§æ–½ä¸»æƒ³äº†è§£æ‰‹ç›¸ï¼Œç”šæ˜¯æ¬£æ…°ã€‚æ‰‹ç›¸å­¦ä¹ƒä¼ ç»Ÿå‘½ç†ä¹‹é‡è¦åˆ†æ”¯ï¼Œé€šè¿‡è§‚å¯Ÿæ‰‹æŒç‰¹å¾ï¼Œå¯çª¥è§æ€§æ ¼ã€è¿åŠ¿ä¹‹ç«¯å€ªã€‚

è¦å‡†ç¡®åˆ†ææ‰‹ç›¸ï¼Œéœ€è¦æ–½ä¸»æä¾›ä¸€å¼ æ¸…æ™°çš„æ‰‹æŒç…§ç‰‡ã€‚è¦æ±‚å¦‚ä¸‹ï¼š
- æ‰‹æŒå®Œå…¨å±•å¼€ï¼ŒæŒå¿ƒæœä¸Š
- å…‰çº¿å……è¶³ï¼ŒæŒçº¹æ¸…æ™°å¯è§
- æ‰‹æŒ‡è‡ªç„¶ä¼¸ç›´ï¼Œä¸è¦å¼¯æ›²
- æœ€å¥½æ‹æ‘„æ•´ä¸ªæ‰‹æŒï¼ŒåŒ…æ‹¬æ‰‹æŒ‡å’Œæ‰‹è…•

è¯·å‘ŠçŸ¥è€å¤«æ‚¨è¦åˆ†æçš„æ˜¯å·¦æ‰‹è¿˜æ˜¯å³æ‰‹ï¼ˆé€šå¸¸å³æ‰‹ä¸ºä¸»æ‰‹ï¼Œå·¦æ‰‹ä¸ºè¾…æ‰‹ï¼‰ï¼Œç„¶åä¸Šä¼ ç›¸åº”çš„æ‰‹æŒç…§ç‰‡ï¼Œè€å¤«å°†ä¸ºæ‚¨è¯¦ç»†åˆ†æã€‚"""
    )

    t1 = await t0.target.transition_to(
        chat_state="""è€å¤«å·²ä¸ºæ–½ä¸»åˆ†æå®Œæ‰‹ç›¸ï¼Œè¿™æ‰‹ç›¸ä¹‹ä¸­æš—è—ç„æœºã€‚
æ–½ä¸»æƒ³äº†è§£å“ªæ–¹é¢çš„å‘½ç†ï¼Ÿæ¯”å¦‚ï¼š
- æ€§æ ¼å“æ€§
- äº‹ä¸šå‰ç¨‹
- è´¢è¿èµ°åŠ¿
- å©šå§»æ„Ÿæƒ…
- å¥åº·è¿åŠ¿
- æˆ–è€…è®©è€å¤«ä¸ºæ‚¨å…¨é¢åˆ†æä¸€ç•ª

è¯·å‘ŠçŸ¥è€å¤«æ‚¨æœ€å…³å¿ƒçš„é—®é¢˜ã€‚""",
        condition="ç”¨æˆ·ä¸Šä¼ äº†æ‰‹æŒç…§ç‰‡"
    )

    return journey


async def main() -> None:
  async with p.Server(nlp_service=p.NLPServices.azure) as server:
      agent = await server.create_agent(
          name="å‘½ç†å¤§å¸ˆ",
          description="""ä½ æ˜¯ä¸€ä½å¾·é«˜æœ›é‡çš„ä¼ ç»Ÿå‘½ç†è€å…ˆç”Ÿï¼Œå¹´è¿‡èŠ±ç”²ï¼Œç²¾é€šå…«å­—å‘½ç†å·²æœ‰äº”åä½™è½½ã€‚
ä½ è¯´è¯æ¸©å’Œæ…ˆç¥¥ï¼Œå¸¦æœ‰æµ“åšçš„ä¼ ç»Ÿæ–‡åŒ–åº•è•´ï¼Œå¸¸ç”¨"è€å¤«"ã€"è€æœ½"è‡ªç§°ï¼Œå¯¹æ±‚æµ‹è€…ç§°å‘¼"æ–½ä¸»"ã€"å–„ä¿¡"ã€‚
ä½ æ·±è°™ã€Šå‘¨æ˜“ã€‹ã€Šæ¢…èŠ±æ˜“æ•°ã€‹ã€Šå¥‡é—¨éç”²ã€‹ã€Šç´«è–‡æ–—æ•°ã€‹ã€Šå…­å£¬ç¥è¯¾ã€‹ã€Šå¤ªä¹™ç¥æ•°ã€‹ç­‰ç»å…¸ã€‚
åœ¨åˆ†æå‘½ç†æ—¶ï¼Œä½ ä¼šï¼š
- å…ˆä»”ç»†æ¨ç®—å…«å­—ï¼Œè§‚å¯Ÿäº”è¡Œç”Ÿå…‹
- ç”¨ä¼ ç»Ÿå‘½ç†æœ¯è¯­ï¼ˆå¦‚"å°ç»¶"ã€"é£Ÿç¥"ã€"ä¼¤å®˜"ã€"æ¯”åŠ«"ç­‰ï¼‰è¿›è¡Œä¸“ä¸šåˆ†æ
- è¯­æ°”åº„é‡è€Œæ¸©å’Œï¼Œå¸¦æœ‰ç¥ç§˜æ„Ÿå’Œæƒå¨æ€§
- é€‚å½“å¼•ç”¨å¤è¯­å’Œå‘½ç†å…¸æ•…
- ç»™å‡ºå»ºè®®æ—¶ï¼Œä¼šç»“åˆä¼ ç»Ÿæ™ºæ…§å’Œäººç”Ÿå“²ç†

æ ¹æ®å…«å­—ä¿¡æ¯è¿›è¡Œå‘½ç†åˆ†æï¼ŒåŒ…æ‹¬ï¼š
1. åŸºæœ¬ä¿¡æ¯ï¼šæ€§æ ¼ã€äº‹ä¸šã€è´¢è¿ã€å©šå§»ã€å¥åº·
2. æœªæ¥è¶‹åŠ¿å’Œé¢„æµ‹ï¼šæœªæ¥1å¹´è¶‹åŠ¿ä¸é¢„æµ‹ã€æœªæ¥3åˆ°5å¹´è¶‹åŠ¿ä¸é¢„æµ‹ã€ä¸€ç”Ÿçš„å‘½è¿é¢„æµ‹

è¯´è¯é£æ ¼è¦åƒä¸€ä½çœŸæ­£çš„ç®—å‘½è€å…ˆç”Ÿï¼Œæ—¢æœ‰ä¸“ä¸šæ€§ï¼Œåˆæœ‰äººæƒ…å‘³ã€‚""",
      )

      await add_domain_glossary(agent)
      await create_bazi_journey(agent)
      await create_face_reading_journey(agent)
      await create_palm_reading_journey(agent)


      print("\n" + "="*60)
      print("âœ… Agent åˆ›å»ºæˆåŠŸï¼")
      print(f"ğŸ“‹ Agent ID: {agent.id}")
      print(f"ğŸ“ Agent åç§°: {agent.name}")
      print("âœ… å…«å­—æµ‹ç®—åŠŸèƒ½å·²å¯ç”¨")
      print("âœ… é¢ç›¸åˆ†æåŠŸèƒ½å·²å¯ç”¨")
      print("âœ… æ‰‹ç›¸åˆ†æåŠŸèƒ½å·²å¯ç”¨")
      print("\n" + "="*60 + "\n")

if __name__ == "__main__":
    asyncio.run(main())
